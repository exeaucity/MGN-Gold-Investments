name: CI
on:
pull_request:
push:
branches: [main]
jobs:
build-and-test:
runs-on: ubuntu-latest
services:
postgres:
image: postgres:16
env:
POSTGRES_USER: app
POSTGRES_PASSWORD: app
POSTGRES_DB: app
ports: ["5432:5432"]
options: >-
--health-cmd "pg_isready -U app" \
--health-interval 5s \
--health-timeout 5s \
--health-retries 5
steps:
- uses: actions/checkout@v4


# --- Backend (Python) ---
- name: Set up Python
uses: actions/setup-python@v5
with:
python-version: '3.12'
- name: Install backend deps
working-directory: backend
run: |
python -m pip install --upgrade pip
pip install -r requirements.txt
- name: Backend sanity
run: python - <<'PY'
print('backend ok')
PY


# --- Frontend (React) ---
- name: Set up Node
uses: actions/setup-node@v4
with:
node-version: 20
- name: Frontend install & build
working-directory: frontend
run: |
npm ci || npm install
npm run build